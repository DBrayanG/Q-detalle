<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Caja</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
      integrity="sha512-wiXDD9F11b6IA98P4oUn7jB9IEliqVQK5dNTR6bl6HClSVL2xzDrRfcJKM5ISVU/6aF2DAu19yy7EMg5xnGUVw=="
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
  </head>
  <body>
    <div class="container">
      <button id="goToTopBtn" onclick="goBack()">
        <a href="/index.html">Inicio</a>
      </button>

      <div class="title">Detalle</div>
      <div class="detail">
        <div class="image">
          <img src="" alt="" />
        </div>
        <div class="content">
          <h1 class="name"></h1>
          <!-- <div class="description"></div> -->
          <div class="modelo"></div>
          <div class="cierre"></div>
          <div class="forro"></div>
          <div class="material"></div>
          <div class="color"></div>
          <div class="dimensiones"></div>
          <div class="nota"></div>
        </div>
      </div>
      <div class="title">Similares</div>
      <div class="listProduct"></div>
    </div>
    <script>
      let products = null;
      fetch("product.json")
        .then((response) => response.json())
        .then((data) => {
          products = data;
          showDetail();
        });
      function showDetail() {
        let detail = document.querySelector(".detail");
        let productId = new URLSearchParams(window.location.search).get("id");

        let thisProduct = products.filter((value) => {
          return value.id == productId;
        })[0];
        if (!thisProduct) {
          window.location.href = "/";
        }
        detail.querySelector(".image img").src = thisProduct.image;
        detail.querySelector(".name").innerText = thisProduct.name;
        detail.querySelector(".modelo").innerHTML = thisProduct.modelo;
        detail.querySelector(".cierre").innerText = thisProduct.cierre;
        detail.querySelector(".dimensiones").innerText =
          thisProduct.dimensiones;
        detail.querySelector(".forro").innerText = thisProduct.forro;
        detail.querySelector(".material").innerText = thisProduct.material;
        detail.querySelector(".color").innerText = thisProduct.color;
        detail.querySelector(".nota").innerHTML = thisProduct.nota;

        let listProducts = document.querySelector(".listProduct");
        products
          .filter((value) => value.id != productId)
          .forEach((product) => {
            if (thisProduct.name == product.name) {
              let newProduct = document.createElement("a");
              newProduct.href = "/detail.html?id=" + product.id;
              newProduct.classList.add("item");
              newProduct.innerHTML = `
          <img src="${product.image}">
          <h2>${product.name}</h2>
          `;
              listProducts.appendChild(newProduct);
            }
          });
      }
      function goBack() {
        window.history.back();
      }
    </script>
  </body>
</html>
